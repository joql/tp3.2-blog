"use strict";function getWidthLeft(e,o){var a=e.position().left,t=e.width(),n={left:a,width:t};if(!o)return n;$(".b-nav-mobile").stop().animate({left:a,width:t},300)}function login(){$("#b-modal-login").modal("show"),setCookie("this_url",window.location.href)}function logout(){$.post(logoutUrl),setTimeout(function(){location.reload()},500)}function goTop(){return $("body,html").animate({scrollTop:0},500),!1}function setCookie(e,o,a){if(a){var t=new Date;t.setTime(t.getTime()+24*a*60*60*1e3);var n="; expires="+t.toGMTString()}else var n="";document.cookie=e+"="+o+n+"; path=/"}function getCookie(e){for(var o=e+"=",a=document.cookie.split(";"),t=0;t<a.length;t++){for(var n=a[t];" "==n.charAt(0);)n=n.substring(1,n.length);if(0==n.indexOf(o))return n.substring(o.length,n.length)}return null}function deleteCookie(e){setCookie(e,"",-1)}function recordId(e,o){return setCookie("cid",0),setCookie("tid",0),setCookie("search_word",0),"index"!=e&&"/"!=e&&setCookie(e,o),!0}function getCheck(){CodeVal=strRand(),showCheck(CodeVal)}function showCheck(e){CodeVal=e;var o=document.getElementById("myCanvas"),a=o.getContext("2d");a.clearRect(0,0,1e3,1e3),a.font="80px 'Hiragino Sans GB'",a.fillStyle="#E8DFE8",a.fillText(e,0,100)}function strRand(){for(var e="",o=new Array(1,2,3,4,5,6,7,8,9,"a","b","c","d","e","f","g","h","j","k","l","m","n","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V","W","X","Y","Z"),a=0;a<4;a++){var t=Math.floor(60*Math.random());void 0!==o[t]&&(e+=o[t])}return e.length<4&&(e=strRand()),e}function reg(){$("#b-modal-reg").modal("show")}function getRegCheck(){RegCodeVal=strRand(),showRegCheck(RegCodeVal)}function showRegCheck(e){RegCodeVal=e;var o=document.getElementById("myCanvas_reg"),a=o.getContext("2d");a.clearRect(0,0,1e3,1e3),a.font="80px 'Hiragino Sans GB'",a.fillStyle="#E8DFE8",a.fillText(e,0,100)}function card(){$("#b-modal-card").modal("show")}var ajax_url=location.protocol+"//"+location.host+"/index.php";$(function(){if("block"==$(".b-nav-mobile").css("display")){var e=getWidthLeft($(".b-nav-active"),!1);$(".b-nav-mobile").css({width:e.width,left:e.left})}$(".b-nav-parent li").hover(function(){getWidthLeft($(this),!0)},function(){getWidthLeft($(".b-nav-active"),!0)}),$(".b-article iframe").width("95%"),$(window).scroll(function(e){$(window).scrollTop()>200?($(".go-top").show(),$(".go-top").removeClass("animated rotateOut"),$(".go-top").addClass("animated rotateIn")):($(".go-top").removeClass("animated rotateIn"),$(".go-top").addClass("animated rotateOut"))}),window.innerWidth>=768&&$(window).scroll(function(e){$(window).scrollTop()>100?$("#b-public-nav").stop().animate({"padding-top":"0px","padding-bottom":"0px"},100):$("#b-public-nav").stop().animate({"padding-top":"5px","padding-bottom":"5px"},100)}),$(".b-page .first,.num,.end").addClass("hidden-xs"),$(".b-page .rows").addClass("hidden-xs"),$(".b-chat-middle").height($(".b-chat").height()),$(".b-arrows-right1,.b-arrows-right2").each(function(e,o){$(o).css("top",$(o).parent(".b-chat-one").height()/2.5)}),$.each($(".js-head-img"),function(e,o){var a=$(o).attr("_src");$(o).attr("src",a)})});var CodeVal;getCheck(),$("div#b-modal-login .login_fields__submit input").click(function(){var e=$('div#b-modal-login .login_fields__user input[name="login"]').val(),o=$('div#b-modal-login .login_fields__password input[name="pwd"]').val(),a=$('div#b-modal-login .login_fields__password input[name="code"]').val(),t=ajax_url+"/Home/User/login";return""==e||""==o?void layer.msg("请输入帐号密码"):a.toLowerCase()!=CodeVal.toLowerCase()?void layer.msg("验证码不正确!"):void $.ajax({url:t,type:"post",data:{username:e,password:$.md5(o)},dataType:"json",success:function(e){1==e.code&&location.reload(),layer.msg(e.msg)},error:function(e,o,a){alert(o+"出错！"+a)}})});var RegCodeVal;getRegCheck(),$("div#b-modal-reg .login_fields__submit input").click(function(){var e=$('div#b-modal-reg .login_fields__user input[name="username"]').val(),o=$('div#b-modal-reg .login_fields__password input[name="pwd"]').val(),a=$('div#b-modal-reg .login_fields__password input[name="pwd2"]').val(),t=$('div#b-modal-reg .login_fields__password input[name="code"]').val(),n=ajax_url+"/Home/User/reg";return""==e||""==o?void layer.msg("请输入帐号密码"):o!=a?void layer.msg("两次密码不一致"):t.toLowerCase()!=RegCodeVal.toLowerCase()?void layer.msg("验证码不正确!"):void $.ajax({url:n,type:"post",data:{username:e,password:$.md5(o)},dataType:"json",success:function(e){1==e.code?setTimeout(function(){$("#b-modal-reg").modal("hide"),$("#b-modal-login").modal("show"),layer.msg("注册成功，请登录")},1e3):layer.msg(e.msg)},error:function(e,o,a){alert(o+"出错！"+a)}})}),$(".UserAvatarEditor-mask").click(function(){$("#file_imgHead").click()}),$("#file_imgHead").change(function(){var e=ajax_url+"/Home/Index/changeHeadImg",o=new FormData;o.append("file",$("#file_imgHead")[0].files[0]),$.ajax({url:e,type:"post",data:o,cache:!1,processData:!1,contentType:!1,dataType:"json",success:function(e){layer.msg(e.msg)},error:function(e,o,a){alert(o+"出错！"+a)}})}),$("div#b-modal-card input.nickname").click(function(){$("div#b-modal-card input.nickname_update").show()}),$("div#b-modal-card input.nickname_update").click(function(){var e=ajax_url+"/Home/Index/changeNickName";$.ajax({url:e,type:"post",data:{name:$("div#b-modal-card input.nickname").val()},dataType:"json",success:function(e){1==e.code&&$("div#b-modal-card input.nickname_update").hide(),layer.msg(e.msg)},error:function(e,o,a){alert(o+"出错！"+a)}})});